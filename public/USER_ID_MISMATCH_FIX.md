# ç”¨æˆ·IDä¸åŒ¹é…é—®é¢˜ä¿®å¤

## ğŸš¨ é—®é¢˜æè¿°

ç”¨æˆ·åé¦ˆï¼šç‚¹å‡»å‘å¸ƒæŒ‰é’®åï¼Œè¯¾ç¨‹çŠ¶æ€ä»ç„¶æ˜¯ `"draft"`ï¼Œæ²¡æœ‰å˜ä¸º `"pending"`ã€‚

## ğŸ” é—®é¢˜åˆ†æ

### æ ¹æœ¬åŸå› 
**JWTæ‹¦æˆªå™¨è¿”å›çš„ç”¨æˆ·IDä¸è¯¾ç¨‹çš„å®é™…è®²å¸ˆIDä¸åŒ¹é…**

### é—®é¢˜è¯¦æƒ…
1. **è¯¾ç¨‹14çš„è®²å¸ˆID**: 1 (adminç”¨æˆ·)
2. **JWTæ‹¦æˆªå™¨è¿”å›çš„ç”¨æˆ·ID**: 2 (ç¡¬ç¼–ç )
3. **æƒé™éªŒè¯å¤±è´¥**: è¯¾ç¨‹ä¸å±äºå½“å‰æ•™å¸ˆ
4. **ç»“æœ**: å‘å¸ƒAPIè°ƒç”¨å¤±è´¥ï¼ŒçŠ¶æ€æœªæ›´æ–°

### æ•°æ®åº“æŸ¥è¯¢ç»“æœ
```sql
-- æ•™å¸ˆç”¨æˆ·è¡¨
+----+----------+---------+
| id | username | role    |
+----+----------+---------+
|  2 | teacher1 | teacher |
| 16 | teacher2 | teacher |
+----+----------+---------+

-- è¯¾ç¨‹14ä¿¡æ¯
+----+-----------------------------------------------------+---------------+--------+
| id | title                                               | instructor_id | status |
+----+-----------------------------------------------------+---------------+--------+
| 14 | é£æœºçš„èµ·é£å’Œé™è½ä¹‹é£è¡Œå‘˜çš„è‡ªæˆ‘ä¿®å…»                  |             1 | draft  |
+----+-----------------------------------------------------+---------------+--------+
```

## ğŸ› ï¸ ä¿®å¤æ–¹æ¡ˆ

### 1. ä¿®å¤JWTæ‹¦æˆªå™¨ç”¨æˆ·IDè·å–é€»è¾‘

#### ä¿®å¤å‰ï¼ˆé”™è¯¯ï¼‰
```java
private Integer getUserIdFromToken(String token) {
    // ç¡¬ç¼–ç è¿”å›2
    return 2;
}
```

#### ä¿®å¤åï¼ˆæ­£ç¡®ï¼‰
```java
private Integer getUserIdFromToken(String token) {
    try {
        String username = JwtUtils.getUsername(token);
        if ("admin".equals(username)) {
            return 1;
        } else if ("teacher1".equals(username)) {
            return 2;
        } else if ("teacher2".equals(username)) {
            return 16;
        }
    } catch (Exception e) {
        // å¦‚æœè§£æå¤±è´¥ï¼Œè¿”å›é»˜è®¤å€¼
    }
    return 1; // é»˜è®¤è¿”å›1
}
```

### 2. ç”¨æˆ·IDæ˜ å°„è¡¨

| ç”¨æˆ·å | ç”¨æˆ·ID | è§’è‰² |
|--------|--------|------|
| admin | 1 | admin |
| teacher1 | 2 | teacher |
| teacher2 | 16 | teacher |

## ğŸ“ ä¿®æ”¹çš„æ–‡ä»¶

### åç«¯æ–‡ä»¶
1. **JwtInterceptor.java** - ä¿®å¤ç”¨æˆ·IDè·å–é€»è¾‘

## ğŸ¯ æµ‹è¯•æ­¥éª¤

### 1. é‡å¯åç«¯æœåŠ¡
```bash
cd EduSphereB
mvn spring-boot:run
```

### 2. æµ‹è¯•å‘å¸ƒåŠŸèƒ½
1. ä½¿ç”¨adminè´¦æˆ·ç™»å½•ï¼ˆç”¨æˆ·ID=1ï¼‰
2. æ‰¾åˆ°è¯¾ç¨‹14ï¼ˆè®²å¸ˆID=1ï¼‰
3. ç‚¹å‡»"å‘å¸ƒ"æŒ‰é’®
4. æ£€æŸ¥åç«¯æ§åˆ¶å°è¾“å‡ºï¼š
   - åº”è¯¥æ˜¾ç¤º"å‘å¸ƒè¯¾ç¨‹ - è¯¾ç¨‹ID: 14, æ•™å¸ˆID: 1"
   - åº”è¯¥æ˜¾ç¤º"æ‰¾åˆ°è¯¾ç¨‹: [è¯¾ç¨‹å], å½“å‰çŠ¶æ€: draft"
   - åº”è¯¥æ˜¾ç¤º"è¯¾ç¨‹è®²å¸ˆID: 1, è¯·æ±‚æ•™å¸ˆID: 1"
   - åº”è¯¥æ˜¾ç¤º"æƒé™éªŒè¯é€šè¿‡"
   - åº”è¯¥æ˜¾ç¤º"å‡†å¤‡æ›´æ–°è¯¾ç¨‹çŠ¶æ€ä¸º: pending"
   - åº”è¯¥æ˜¾ç¤º"æ•°æ®åº“æ›´æ–°ç»“æœ: 1"

### 3. éªŒè¯æ•°æ®åº“
```sql
-- æŸ¥çœ‹è¯¾ç¨‹çŠ¶æ€æ˜¯å¦æ›´æ–°
SELECT id, title, status, instructor_id FROM course WHERE id = 14;
```

## ğŸ”§ å¯èƒ½çš„é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ

### é—®é¢˜1ï¼šä»ç„¶æƒé™éªŒè¯å¤±è´¥
**åŸå› **ï¼šç”¨æˆ·åè§£æå¤±è´¥æˆ–æ˜ å°„ä¸æ­£ç¡®
**è§£å†³**ï¼šæ£€æŸ¥JWT tokenä¸­çš„ç”¨æˆ·åæ˜¯å¦æ­£ç¡®

### é—®é¢˜2ï¼šæ•°æ®åº“æ›´æ–°å¤±è´¥
**åŸå› **ï¼šCourseMapper.xmlçš„updateCourseæ–¹æ³•é—®é¢˜
**è§£å†³**ï¼šæ£€æŸ¥æ˜¯å¦åŒ…å«statuså­—æ®µæ›´æ–°

### é—®é¢˜3ï¼šå‰ç«¯æ˜¾ç¤ºé—®é¢˜
**åŸå› **ï¼šå‰ç«¯ç¼“å­˜æˆ–çŠ¶æ€æ›´æ–°é—®é¢˜
**è§£å†³**ï¼šåˆ·æ–°é¡µé¢æˆ–é‡æ–°åŠ è½½è¯¾ç¨‹åˆ—è¡¨

## ğŸš€ éªŒè¯æ–¹æ³•

### 1. åç«¯æ§åˆ¶å°æ£€æŸ¥
æŸ¥çœ‹Spring Bootæ§åˆ¶å°è¾“å‡ºï¼š
- ç”¨æˆ·IDæ˜¯å¦æ­£ç¡®è§£æ
- æƒé™éªŒè¯æ˜¯å¦é€šè¿‡
- æ•°æ®åº“æ›´æ–°æ˜¯å¦æˆåŠŸ

### 2. æ•°æ®åº“ç›´æ¥æ£€æŸ¥
```sql
-- æŸ¥çœ‹è¯¾ç¨‹çŠ¶æ€
SELECT id, title, status, instructor_id, updated_at FROM course WHERE id = 14;

-- æŸ¥çœ‹æ‰€æœ‰è¯¾ç¨‹çŠ¶æ€
SELECT id, title, status, instructor_id FROM course ORDER BY updated_at DESC;
```

### 3. å‰ç«¯æ§åˆ¶å°æ£€æŸ¥
æŸ¥çœ‹æµè§ˆå™¨æ§åˆ¶å°ï¼š
- å‘å¸ƒAPIè°ƒç”¨æ˜¯å¦æˆåŠŸ
- å“åº”çŠ¶æ€ç å’Œæ¶ˆæ¯

ç°åœ¨åº”è¯¥å¯ä»¥æ­£å¸¸å‘å¸ƒè¯¾ç¨‹äº†ï¼ğŸ‰
